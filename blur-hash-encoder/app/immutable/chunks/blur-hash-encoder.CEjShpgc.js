import{p as Be,a as xe,u as ke,b as Je,o as Ne,f as ne,i as z,c as we,d as ye,e as E,g as Ue,t as k,h as l,s as F,j as Ke,k as _e,l as m,m as K,n as Me,q as y,r as re,v as Q,w as ee,x as f,y as W,z as Ge,L as Qe,E as Xe,A as Ye,B as Ze,C as $e,D as Pe,$ as et,F as tt,G as at,H as Ce,I as He,J as pe,K as De,M as ge,N as st,O as rt,P as nt,Q as ot,R as lt,S as ct,T as Le}from"./vendor.C9jU6pzy.js";var je;const it=((je=globalThis.__sveltekit_158k53q)==null?void 0:je.base)??"/blur-hash-encoder";var Ae;const Rt=((Ae=globalThis.__sveltekit_158k53q)==null?void 0:Ae.assets)??it,jt="1728253733729",ut="modulepreload",dt=function(h,c){return new URL(h,c).href},Re={},Ie=function(c,p,M){let C=Promise.resolve();if(p&&p.length>0){const b=document.getElementsByTagName("link"),x=document.querySelector("meta[property=csp-nonce]"),q=(x==null?void 0:x.nonce)||(x==null?void 0:x.getAttribute("nonce"));C=Promise.allSettled(p.map(H=>{if(H=dt(H,M),H in Re)return;Re[H]=!0;const A=H.endsWith(".css"),a=A?'[rel="stylesheet"]':"";if(!!M)for(let s=b.length-1;s>=0;s--){const o=b[s];if(o.href===H&&(!A||o.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${H}"]${a}`))return;const t=document.createElement("link");if(t.rel=A?"stylesheet":ut,A||(t.as="script"),t.crossOrigin="",t.href=H,q&&t.setAttribute("nonce",q),document.head.appendChild(t),A)return new Promise((s,o)=>{t.addEventListener("load",s),t.addEventListener("error",()=>o(new Error(`Unable to preload CSS for ${H}`)))})}))}function S(b){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=b,window.dispatchEvent(x),!x.defaultPrevented)throw b}return C.then(b=>{for(const x of b||[])x.status==="rejected"&&S(x.reason);return c().catch(S)})},At={};var vt=k('<div id="svelte-announcer" aria-live="assertive" aria-atomic="true" style="position: absolute; left: 0; top: 0; clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap; width: 1px; height: 1px"><!></div>'),mt=k("<!> <!>",1);function ht(h,c){Be(c,!0);let p=xe(c,"components",23,()=>[]),M=xe(c,"data_0",3,null),C=xe(c,"data_1",3,null);ke(()=>c.stores.page.set(c.page)),Je(()=>{c.stores,c.page,c.constructors,p(),c.form,M(),C(),c.stores.page.notify()});let S=K(!1),b=K(!1),x=K(null);Ne(()=>{const e=c.stores.page.subscribe(()=>{l(S)&&(F(b,!0),Ke().then(()=>{F(x,_e(document.title||"untitled page"))}))});return F(S,!0),e});const q=W(()=>c.constructors[1]);var H=mt(),A=ne(H);z(A,()=>c.constructors[1],e=>{var t=we();const s=W(()=>c.constructors[0]);var o=ne(t);ye(o,()=>l(s),(d,T)=>{Me(T(d,{get data(){return M()},get form(){return c.form},children:(P,L)=>{var g=we(),u=ne(g);ye(u,()=>l(q),(i,_)=>{Me(_(i,{get data(){return C()},get form(){return c.form}}),B=>p()[1]=B,()=>{var B;return(B=p())==null?void 0:B[1]})}),E(P,g)},$$slots:{default:!0}}),P=>p()[0]=P,()=>{var P;return(P=p())==null?void 0:P[0]})}),E(e,t)},e=>{var t=we();const s=W(()=>c.constructors[0]);var o=ne(t);ye(o,()=>l(s),(d,T)=>{Me(T(d,{get data(){return M()},get form(){return c.form}}),P=>p()[0]=P,()=>{var P;return(P=p())==null?void 0:P[0]})}),E(e,t)});var a=m(A,2);z(a,()=>l(S),e=>{var t=vt(),s=y(t);z(s,()=>l(b),o=>{var d=re();Q(()=>ee(d,l(x))),E(o,d)}),f(t),E(e,t)}),E(h,H),Ue()}const Bt=Ge(ht),Ut=[()=>Ie(()=>Promise.resolve().then(()=>gt),void 0,import.meta.url),()=>Ie(()=>Promise.resolve().then(()=>_t),void 0,import.meta.url),()=>Ie(()=>Promise.resolve().then(()=>Ht),void 0,import.meta.url)],qt=[],zt={"/":[2]},Ft={handleError:({error:h})=>{console.error(h)},reroute:()=>{}},pt=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),gt=Object.freeze(Object.defineProperty({__proto__:null,component:Qe,universal:pt},Symbol.toStringTag,{value:"Module"})),_t=Object.freeze(Object.defineProperty({__proto__:null,component:Xe},Symbol.toStringTag,{value:"Module"})),Ee=function(h){const c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],p=a=>{let e=0;for(let t=0;t<a.length;t++){const s=a[t];e=83*e+c.indexOf(s)}return e},M=(a,e)=>{var t="";for(let s=1;s<=e;s++){let o=Math.floor(a)/Math.pow(83,e-s)%83;t+=c[Math.floor(o)]}return t},C=a=>{let e=a/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},S=a=>{let e=Math.max(0,Math.min(1,a));return e<=.0031308?Math.round(12.92*e*255+.5):Math.round(255*(1.055*Math.pow(e,.4166666666666667)-.055)+.5)},b=(a,e)=>(t=>t<0?-1:1)(a)*Math.pow(Math.abs(a),e),x=a=>{if(!a||a.length<6)throw new Error("The blurhash string must be at least 6 characters");const e=p(a[0]),t=Math.floor(e/9)+1,s=e%9+1;if(a.length!==4+2*s*t)throw new Error(`blurhash length mismatch: length is ${a.length} but it should be ${4+2*s*t}`)},q=a=>{const e=a>>8&255,t=255&a;return[C(a>>16),C(e),C(t)]},H=(a,e)=>{const t=Math.floor(a/361),s=Math.floor(a/19)%19,o=a%19;return[b((t-9)/9,2)*e,b((s-9)/9,2)*e,b((o-9)/9,2)*e]},A=(a,e,t,s)=>{let o=0,d=0,T=0;const P=4*e;for(let g=0;g<e;g++)for(let u=0;u<t;u++){const i=s(g,u);o+=i*C(a[4*g+0+u*P]),d+=i*C(a[4*g+1+u*P]),T+=i*C(a[4*g+2+u*P])}let L=1/(e*t);return[o*L,d*L,T*L]};return h.decodePromise=(a,e,t,s=1)=>new Promise((o,d)=>{o(h.decode(a,e,t,s))}),h.decode=(a,e,t,s=1)=>{x(a),s|=1;const o=p(a[0]),d=Math.floor(o/9)+1,T=o%9+1,P=(p(a[1])+1)/166,L=new Array(T*d);for(let i=0;i<L.length;i++)if(i===0){const _=p(a.substring(2,6));L[i]=q(_)}else{const _=p(a.substring(4+2*i,6+2*i));L[i]=H(_,P*s)}const g=4*e,u=new Uint8ClampedArray(g*t);for(let i=0;i<t;i++)for(let _=0;_<e;_++){let B=0,J=0,G=0;for(let te=0;te<d;te++)for(let X=0;X<T;X++){const ae=Math.cos(Math.PI*_*X/e)*Math.cos(Math.PI*i*te/t);let le=L[X+te*T];B+=le[0]*ae,J+=le[1]*ae,G+=le[2]*ae}let me=S(B),oe=S(J),he=S(G);u[4*_+0+i*g]=me,u[4*_+1+i*g]=oe,u[4*_+2+i*g]=he,u[4*_+3+i*g]=255}return u},h.encodePromise=(a,e,t,s,o)=>new Promise((d,T)=>{d(h.encode(a,e,t,s,o))}),h.encode=(a,e,t,s,o)=>{if(s<1||s>9||o<1||o>9)throw new Error("BlurHash must have between 1 and 9 components");if(e*t*4!==a.length)throw new Error("Width and height must match the pixels array");let d=[];for(let u=0;u<o;u++)for(let i=0;i<s;i++){const _=i==0&&u==0?1:2,B=A(a,e,t,(J,G)=>_*Math.cos(Math.PI*i*J/e)*Math.cos(Math.PI*u*G/t));d.push(B)}const T=d[0],P=d.slice(1);let L,g="";if(g+=M(s-1+9*(o-1),1),P.length>0){let u=Math.max(...P.map(_=>Math.max(..._))),i=Math.floor(Math.max(0,Math.min(82,Math.floor(166*u-.5))));L=(i+1)/166,g+=M(i,1)}else L=1,g+=M(0,1);return g+=M((u=>(S(u[0])<<16)+(S(u[1])<<8)+S(u[2]))(T),4),P.forEach(u=>{g+=M(((i,_)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*b(i[0]/_,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*b(i[1]/_,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*b(i[2]/_,.5)+9.5)))))(u,L),2)}),g},h.getImageData=a=>{const e=a.width,t=a.height,s=document.createElement("canvas"),o=s.getContext("2d");return s.width=e,s.height=t,o.width=e,o.height=t,o.drawImage(a,0,0),o.getImageData(0,0,e,t).data},h.drawImageDataOnNewCanvas=(a,e,t)=>{const s=document.createElement("canvas"),o=s.getContext("2d");return s.width=e,s.height=t,o.width=e,o.height=t,o.putImageData(new ImageData(a,e,t),0,0),s},h.getImageDataAsImageWithOnloadPromise=(a,e,t)=>new Promise((s,o)=>{h.getImageDataAsImage(a,e,t,(d,T)=>{s(T)})}),h.getImageDataAsImage=(a,e,t,s)=>{const o=h.drawImageDataOnNewCanvas(a,e,t).toDataURL(),d=new Image(e,t);return d.onload=T=>s(T,d),d.width=e,d.height=t,d.src=o,d},h}({});async function ft(h,c,p){const M=l(c).split(/\r?\n/).filter(C=>C.trim()!=="");await new Promise(C=>setTimeout(C,0)),F(c,""),p(M)}async function bt(h,c,p){F(c,_e(l(c).filter(M=>M.status!=="failed"))),F(p,!0),await new Promise(M=>setTimeout(M,2e3)),F(p,!1)}var xt=tt('<script src="analytics.js"><\/script><!---->',1),wt=k('<img alt="BlurHash" class="svelte-1c9cxpu">'),yt=k('<span class="not-available svelte-1c9cxpu">n/a</span>'),Mt=(h,c,p)=>c(h,p().blurHash),Pt=k('<input class="blur-hash svelte-1c9cxpu" type="text" title="Copy" readonly=""> <button class="copy-button svelte-1c9cxpu">⧉</button>',1),Ct=k('| <span class="cors-tag svelte-1c9cxpu" title="Used CORS proxy">CORS</span>',1),Dt=k("<span> </span>"),It=k('<div class="item svelte-1c9cxpu"><div class="thumbnail image-thumbnail svelte-1c9cxpu"><img alt="Original" class="svelte-1c9cxpu"></div> <div class="spacer svelte-1c9cxpu"></div> <div class="thumbnail blur-hash-thumbnail svelte-1c9cxpu"><!> <!></div> <div class="spacer svelte-1c9cxpu"></div> <div class="info svelte-1c9cxpu"><div class="blur-hash-section svelte-1c9cxpu"><span class="label svelte-1c9cxpu">BlurHash:</span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Components:</span> <span> </span></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">URL:</span> <a target="_blank"> </a></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Status:</span> <span> </span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Duration:</span> <!></div></div></div>'),Et=k('<button class="tool-bar-button svelte-1c9cxpu" title="Export completed tasks"><!></button>'),St=k('<button class="tool-bar-button svelte-1c9cxpu" title="Clear failed tasks"><!></button>'),Tt=k('<div id="page-layout" class="svelte-1c9cxpu"><header class="svelte-1c9cxpu"><h1>BlurHash Encoder</h1> <textarea id="input" rows="4" placeholder="Enter image URLs" class="svelte-1c9cxpu"></textarea> <div id="tool-bar" class="svelte-1c9cxpu"><button class="tool-bar-button svelte-1c9cxpu">Encode</button> <div id="settings" class="svelte-1c9cxpu">Components: <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"> ✕ <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"></div> <div id="tools" class="svelte-1c9cxpu"><span> <!></span> | <span> <!></span></div></div></header> <main class="svelte-1c9cxpu"><noscript></noscript> <div id="items"></div></main> <footer class="svelte-1c9cxpu">Made with <a href="https://kit.svelte.dev/">SvelteKit</a> 5</footer></div>');function Ot(h,c){Be(c,!0);const p=(n,r=lt)=>{var D=It(),w=y(D),v=y(w);f(w);var I=m(w,4),O=y(I);z(O,()=>r().blurHashImageSrc,V=>{var R=wt();Q(()=>ge(R,"src",r().blurHashImageSrc)),E(V,R)});var U=m(O,2);z(U,()=>r().status==="failed",V=>{var R=yt();E(V,R)}),f(I);var j=m(I,4),Y=y(j),ce=m(y(Y),2);z(ce,()=>r().blurHash!=="",V=>{var R=Pt(),ve=ne(R);Ce(ve);var be=m(ve,2);be.__click=[Mt,T,r],Q(()=>st(ve,r().blurHash)),E(V,R)},V=>{var R=re("n/a");E(V,R)}),f(Y);var Z=m(Y,2),ie=m(y(Z),2),fe=y(ie);f(ie),f(Z);var ue=m(Z,2),de=m(y(ue),2),$=y(de);f(de),f(ue);var N=m(ue,2),se=m(y(N),2),qe=y(se);f(se);var ze=m(se,2);z(ze,()=>r().usedCorsProxy,V=>{var R=Ct();He(),E(V,R)}),f(N);var Oe=m(N,2),Fe=m(y(Oe),2);z(Fe,()=>r().endDate,V=>{var R=Dt();const ve=W(()=>r().endDate.getTime()-r().startDate.getTime()),be=W(()=>r().startDate.toLocaleString()+"."+r().startDate.getMilliseconds()),Ve=W(()=>r().endDate.toLocaleString()+"."+r().endDate.getMilliseconds());var We=y(R);f(R),Q(()=>{ge(R,"title",`${l(be)??""} - ${l(Ve)??""}`),ee(We,`${l(ve)??""} ms`)}),E(V,R)}),f(Oe),f(j),f(D),Q(()=>{ge(v,"src",r().imageSrc),ee(fe,`${r().xComponents??""} ✕ ${r().yComponents??""}`),ge(de,"href",r().imageSrc),ee($,r().imageSrc),rt(se,`task-status ${r().status??""} svelte-1c9cxpu`),ee(qe,r().status)}),nt("error",v,d),ot(v),De(3,D,()=>ct,()=>({x:"50%"})),E(n,D)};let M=K(""),C=K(4),S=K(4),b=K(_e([])),x=K(!1),q=K(!1);const H=W(()=>l(b).filter(n=>n.status==="completed").length),A=W(()=>l(b).filter(n=>n.status==="failed").length),a=W(()=>l(M).trim()===""),e=W(()=>l(C)>0&&l(S)>0),t=W(()=>l(a)||!l(e));function s(n){const r=l(C),D=l(S),w=n.map(v=>_e({url:v,xComponents:r,yComponents:D,blurHash:"",image:new Image,imageSrc:v,blurHashImage:new Image,blurHashImageSrc:"",startDate:new Date,endDate:null,usedCorsProxy:!1,status:"in-progress",error:null}));l(b).unshift(...w);for(const v of w)o(v)}async function o(n){const r=new Date;n.startDate=r;const D=n.url;let w=null,v=!1;const I=new Image;I.crossOrigin="Anonymous";try{await new Promise(($,N)=>{I.onload=$,I.onerror=N,I.src=D})}catch($){w=$}if(w!=null){w=null;const $=`https://corsproxy.io/?${encodeURIComponent(D)}`;try{await new Promise((N,se)=>{I.onload=N,I.onerror=se,I.src=$}),v=!0}catch(N){w=N}}if(w!=null){n.status="failed",n.error=w,n.endDate=new Date;return}const O=64;let U=I.width,j=I.height;U>j?U>O&&(j=Math.round(j*O/U),U=O):j>O&&(U=Math.round(U*O/j),j=O);const Y=document.createElement("canvas");Y.width=U,Y.height=j;const ce=Y.getContext("2d");if(ce==null){n.status="failed",n.error=new Error("Failed to get 2d context"),n.endDate=new Date,n.usedCorsProxy=v;return}ce.drawImage(I,0,0,I.width,I.height,0,0,U,j);const Z=ce.getImageData(0,0,U,j),ie=await Ee.encodePromise(Z.data,Z.width,Z.height,n.xComponents,n.yComponents),fe=await Ee.decodePromise(ie,U,j,1),ue=await Ee.getImageDataAsImageWithOnloadPromise(fe,U,j),de=new Date;n.endDate=de,n.blurHash=ie,n.blurHashImageSrc=ue.src,n.status="completed",n.usedCorsProxy=v}function d(n){n.target.classList.add("broken-image")}async function T(n,r){try{await navigator.clipboard.writeText(r)}catch(v){console.error("Failed to copy text: ",v);return}const D=n.target;D instanceof HTMLButtonElement&&(D.classList.add("success"),D.disabled=!0,await new Promise(v=>setTimeout(v,1e3)),D.classList.remove("success"),D.disabled=!1)}async function P(){const r=l(b).filter(O=>O.status==="completed").map(O=>({url:O.url,xComponents:O.xComponents,yComponents:O.yComponents,blurHash:O.blurHash})),D=JSON.stringify(r,null,2),w=new Blob([D],{type:"application/json"}),v=URL.createObjectURL(w),I=document.createElement("a");I.href=v,I.download="blur-hashes.json",I.click(),URL.revokeObjectURL(v),F(x,!0),await new Promise(O=>setTimeout(O,2e3)),F(x,!1)}var L=Tt();Ze(n=>{var r=xt();et.title="BlurHash Encoder";var D=m(ne(r));E(n,r)});var g=y(L),u=m(y(g),2);at(u);var i=m(u,2),_=y(i);_.__click=[ft,M,s];var B=m(_,2),J=m(y(B));Ce(J);var G=m(J,2);Ce(G),f(B);var me=m(B,2),oe=y(me),he=y(oe),te=m(he);z(te,()=>l(H)>0,n=>{var r=Et();r.__click=P;var D=y(r);z(D,()=>l(x),w=>{var v=re("Exported");E(w,v)},w=>{var v=re("📥 Export");E(w,v)}),f(r),Q(()=>{r.disabled=l(x),pe(r,"success",l(x))}),De(3,r,()=>Le),E(n,r)}),f(oe);var X=m(oe,2),ae=y(X),le=m(ae);z(le,()=>l(A)>0||l(q),n=>{var r=St();r.__click=[bt,b,q];var D=y(r);z(D,()=>l(q),w=>{var v=re("Cleared");E(w,v)},w=>{var v=re("❌ Clear");E(w,v)}),f(r),Q(()=>{r.disabled=l(q),pe(r,"success",l(q))}),De(3,r,()=>Le),E(n,r)}),f(X),f(me),f(i),f(g);var Se=m(g,2),Te=m(y(Se),2);$e(Te,21,()=>l(b),n=>n.url,(n,r)=>{p(n,()=>l(r))}),f(Te),f(Se),He(2),f(L),Q(()=>{_.disabled=l(t),pe(J,"invalid",l(C)<=0),pe(G,"invalid",l(S)<=0),ee(he,`Completed: ${l(H)??""} `),ee(ae,`Failed: ${l(A)??""} `)}),Pe(u,()=>l(M),n=>F(M,n)),Pe(J,()=>l(C),n=>F(C,n)),Pe(G,()=>l(S),n=>F(S,n)),E(h,L),Ue()}Ye(["click"]);const Ht=Object.freeze(Object.defineProperty({__proto__:null,component:Ot},Symbol.toStringTag,{value:"Module"}));export{pt as _,Rt as a,it as b,Ot as c,zt as d,Ft as h,At as m,Ut as n,Bt as r,qt as s,jt as v};
