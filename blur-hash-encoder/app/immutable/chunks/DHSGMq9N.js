import{p as Fe,a as Me,u as Ze,b as $e,o as et,g as l,s as K,c as V,t as tt,d as ge,e as J,f as ne,i as F,h as f,j as S,k as Ve,l as Pe,m as Ie,n as M,r as b,q as De,v as q,w as oe,x as X,y as $,z as at,L as st,E as rt,A as ot,B as nt,C as lt,D as Ce,F as ct,$ as it,G as ut,H as Ee,I as Re,J as pe,K as Se,M as dt,N as fe,O as vt,P as mt,Q as ht,R as pt,S as ft,T as Ae}from"./CqSrKLzm.js";var Ue;const gt=((Ue=globalThis.__sveltekit_ospjzo)==null?void 0:Ue.base)??"/blur-hash-encoder";var ze;const Jt=((ze=globalThis.__sveltekit_ospjzo)==null?void 0:ze.assets)??gt,Nt="1739802614114",_t="modulepreload",bt=function(h,i){return new URL(h,i).href},Be={},Te=function(i,g,P){let I=Promise.resolve();if(g&&g.length>0){const x=document.getElementsByTagName("link"),w=document.querySelector("meta[property=csp-nonce]"),z=(w==null?void 0:w.nonce)||(w==null?void 0:w.getAttribute("nonce"));I=Promise.allSettled(g.map(H=>{if(H=bt(H,P),H in Be)return;Be[H]=!0;const U=H.endsWith(".css"),t=U?'[rel="stylesheet"]':"";if(!!P)for(let n=x.length-1;n>=0;n--){const s=x[n];if(s.href===H&&(!U||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${H}"]${t}`))return;const a=document.createElement("link");if(a.rel=U?"stylesheet":_t,U||(a.as="script"),a.crossOrigin="",a.href=H,z&&a.setAttribute("nonce",z),document.head.appendChild(a),U)return new Promise((n,s)=>{a.addEventListener("load",n),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${H}`)))})}))}function O(x){const w=new Event("vite:preloadError",{cancelable:!0});if(w.payload=x,window.dispatchEvent(w),!w.defaultPrevented)throw x}return I.then(x=>{for(const w of x||[])w.status==="rejected"&&O(w.reason);return i().catch(O)})},kt={};var xt=J('<div id="svelte-announcer" aria-live="assertive" aria-atomic="true" style="position: absolute; left: 0; top: 0; clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap; width: 1px; height: 1px"><!></div>'),wt=J("<!> <!>",1);function yt(h,i){Fe(i,!0);let g=Me(i,"components",23,()=>[]),P=Me(i,"data_0",3,null),I=Me(i,"data_1",3,null);Ze(()=>i.stores.page.set(i.page)),$e(()=>{i.stores,i.page,i.constructors,g(),i.form,P(),I(),i.stores.page.notify()});let O=K(!1),x=K(!1),w=K(null);et(()=>{const s=i.stores.page.subscribe(()=>{l(O)&&(V(x,!0),tt().then(()=>{V(w,ge(document.title||"untitled page"))}))});return V(O,!0),s});const z=q(()=>i.constructors[1]);var H=wt(),U=ne(H);{var t=s=>{var v=Pe();const C=q(()=>i.constructors[0]);var L=ne(v);Ie(L,()=>l(C),(y,p)=>{De(p(y,{get data(){return P()},get form(){return i.form},children:(c,d)=>{var _=Pe(),N=ne(_);Ie(N,()=>l(z),(W,k)=>{De(k(W,{get data(){return I()},get form(){return i.form}}),G=>g()[1]=G,()=>{var G;return(G=g())==null?void 0:G[1]})}),S(c,_)},$$slots:{default:!0}}),c=>g()[0]=c,()=>{var c;return(c=g())==null?void 0:c[0]})}),S(s,v)},e=s=>{var v=Pe();const C=q(()=>i.constructors[0]);var L=ne(v);Ie(L,()=>l(C),(y,p)=>{De(p(y,{get data(){return P()},get form(){return i.form}}),c=>g()[0]=c,()=>{var c;return(c=g())==null?void 0:c[0]})}),S(s,v)};F(U,s=>{i.constructors[1]?s(t):s(e,!1)})}var a=f(U,2);{var n=s=>{var v=xt(),C=M(v);{var L=y=>{var p=oe();X(()=>$(p,l(w))),S(y,p)};F(C,y=>{l(x)&&y(L)})}b(v),S(s,v)};F(a,s=>{l(O)&&s(n)})}S(h,H),Ve()}const Gt=at(yt),Kt=[()=>Te(()=>Promise.resolve().then(()=>Dt),void 0,import.meta.url),()=>Te(()=>Promise.resolve().then(()=>Ct),void 0,import.meta.url),()=>Te(()=>Promise.resolve().then(()=>Wt),void 0,import.meta.url)],Qt=[],Xt={"/":[2]},Mt={handleError:({error:h})=>{console.error(h)},reroute:()=>{},transport:{}},Pt=Object.fromEntries(Object.entries(Mt.transport).map(([h,i])=>[h,i.decode])),Yt=!1,Zt=(h,i)=>Pt[h](i),It=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Dt=Object.freeze(Object.defineProperty({__proto__:null,component:st,universal:It},Symbol.toStringTag,{value:"Module"})),Ct=Object.freeze(Object.defineProperty({__proto__:null,component:rt},Symbol.toStringTag,{value:"Module"})),Oe=function(h){const i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],g=t=>{let e=0;for(let a=0;a<t.length;a++){const n=t[a];e=83*e+i.indexOf(n)}return e},P=(t,e)=>{var a="";for(let n=1;n<=e;n++){let s=Math.floor(t)/Math.pow(83,e-n)%83;a+=i[Math.floor(s)]}return a},I=t=>{let e=t/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},O=t=>{let e=Math.max(0,Math.min(1,t));return e<=.0031308?Math.round(12.92*e*255+.5):Math.round(255*(1.055*Math.pow(e,.4166666666666667)-.055)+.5)},x=(t,e)=>(a=>a<0?-1:1)(t)*Math.pow(Math.abs(t),e),w=t=>{if(!t||t.length<6)throw new Error("The blurhash string must be at least 6 characters");const e=g(t[0]),a=Math.floor(e/9)+1,n=e%9+1;if(t.length!==4+2*n*a)throw new Error(`blurhash length mismatch: length is ${t.length} but it should be ${4+2*n*a}`)},z=t=>{const e=t>>8&255,a=255&t;return[I(t>>16),I(e),I(a)]},H=(t,e)=>{const a=Math.floor(t/361),n=Math.floor(t/19)%19,s=t%19;return[x((a-9)/9,2)*e,x((n-9)/9,2)*e,x((s-9)/9,2)*e]},U=(t,e,a,n)=>{let s=0,v=0,C=0;const L=4*e;for(let p=0;p<e;p++)for(let c=0;c<a;c++){const d=n(p,c);s+=d*I(t[4*p+0+c*L]),v+=d*I(t[4*p+1+c*L]),C+=d*I(t[4*p+2+c*L])}let y=1/(e*a);return[s*y,v*y,C*y]};return h.decodePromise=(t,e,a,n=1)=>new Promise((s,v)=>{s(h.decode(t,e,a,n))}),h.decode=(t,e,a,n=1)=>{w(t),n|=1;const s=g(t[0]),v=Math.floor(s/9)+1,C=s%9+1,L=(g(t[1])+1)/166,y=new Array(C*v);for(let d=0;d<y.length;d++)if(d===0){const _=g(t.substring(2,6));y[d]=z(_)}else{const _=g(t.substring(4+2*d,6+2*d));y[d]=H(_,L*n)}const p=4*e,c=new Uint8ClampedArray(p*a);for(let d=0;d<a;d++)for(let _=0;_<e;_++){let N=0,W=0,k=0;for(let ee=0;ee<v;ee++)for(let te=0;te<C;te++){const ae=Math.cos(Math.PI*_*te/e)*Math.cos(Math.PI*d*ee/a);let se=y[te+ee*C];N+=se[0]*ae,W+=se[1]*ae,k+=se[2]*ae}let G=O(N),le=O(W),ve=O(k);c[4*_+0+d*p]=G,c[4*_+1+d*p]=le,c[4*_+2+d*p]=ve,c[4*_+3+d*p]=255}return c},h.encodePromise=(t,e,a,n,s)=>new Promise((v,C)=>{v(h.encode(t,e,a,n,s))}),h.encode=(t,e,a,n,s)=>{if(n<1||n>9||s<1||s>9)throw new Error("BlurHash must have between 1 and 9 components");if(e*a*4!==t.length)throw new Error("Width and height must match the pixels array");let v=[];for(let c=0;c<s;c++)for(let d=0;d<n;d++){const _=d==0&&c==0?1:2,N=U(t,e,a,(W,k)=>_*Math.cos(Math.PI*d*W/e)*Math.cos(Math.PI*c*k/a));v.push(N)}const C=v[0],L=v.slice(1);let y,p="";if(p+=P(n-1+9*(s-1),1),L.length>0){let c=Math.max(...L.map(_=>Math.max(..._))),d=Math.floor(Math.max(0,Math.min(82,Math.floor(166*c-.5))));y=(d+1)/166,p+=P(d,1)}else y=1,p+=P(0,1);return p+=P((c=>(O(c[0])<<16)+(O(c[1])<<8)+O(c[2]))(C),4),L.forEach(c=>{p+=P(((d,_)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*x(d[0]/_,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*x(d[1]/_,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*x(d[2]/_,.5)+9.5)))))(c,y),2)}),p},h.getImageData=t=>{const e=t.width,a=t.height,n=document.createElement("canvas"),s=n.getContext("2d");return n.width=e,n.height=a,s.width=e,s.height=a,s.drawImage(t,0,0),s.getImageData(0,0,e,a).data},h.drawImageDataOnNewCanvas=(t,e,a)=>{const n=document.createElement("canvas"),s=n.getContext("2d");return n.width=e,n.height=a,s.width=e,s.height=a,s.putImageData(new ImageData(t,e,a),0,0),n},h.getImageDataAsImageWithOnloadPromise=(t,e,a)=>new Promise((n,s)=>{h.getImageDataAsImage(t,e,a,(v,C)=>{n(C)})}),h.getImageDataAsImage=(t,e,a,n)=>{const s=h.drawImageDataOnNewCanvas(t,e,a).toDataURL(),v=new Image(e,a);return v.onload=C=>n(C,v),v.width=e,v.height=a,v.src=s,v},h}({});async function Et(h,i,g){const P=l(i).split(/\r?\n/).filter(I=>I.trim()!=="");await new Promise(I=>setTimeout(I,0)),V(i,""),g(P)}async function St(h,i,g){V(i,ge(l(i).filter(P=>P.status!=="failed"))),V(g,!0),await new Promise(P=>setTimeout(P,2e3)),V(g,!1)}var Tt=ct('<script src="analytics.js"><\/script><!---->',1),Ot=J('<img alt="BlurHash" class="svelte-1c9cxpu">'),jt=J('<span class="not-available svelte-1c9cxpu">n/a</span>'),Ht=(h,i,g)=>i(h,g().blurHash),Lt=J('<input class="blur-hash svelte-1c9cxpu" type="text" title="Copy" readonly=""> <button class="copy-button svelte-1c9cxpu">⧉</button>',1),Rt=J('| <span class="cors-tag svelte-1c9cxpu" title="Used CORS proxy">CORS</span>',1),At=J("<span> </span>"),Bt=J('<div class="item svelte-1c9cxpu"><div class="thumbnail image-thumbnail svelte-1c9cxpu"><img alt="Original" class="svelte-1c9cxpu"></div> <div class="spacer svelte-1c9cxpu"></div> <div class="thumbnail blur-hash-thumbnail svelte-1c9cxpu"><!> <!></div> <div class="spacer svelte-1c9cxpu"></div> <div class="info svelte-1c9cxpu"><div class="blur-hash-section svelte-1c9cxpu"><span class="label svelte-1c9cxpu">BlurHash:</span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Components:</span> <span> </span></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">URL:</span> <a target="_blank"> </a></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Status:</span> <span> </span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Duration:</span> <!></div></div></div>'),Ut=J('<button class="tool-bar-button svelte-1c9cxpu" title="Export completed tasks"><!></button>'),zt=J('<button class="tool-bar-button svelte-1c9cxpu" title="Clear failed tasks"><!></button>'),Ft=J('<div id="page-layout" class="svelte-1c9cxpu"><header class="svelte-1c9cxpu"><h1>BlurHash Encoder</h1> <textarea id="input" rows="4" placeholder="Enter image URLs" class="svelte-1c9cxpu"></textarea> <div id="tool-bar" class="svelte-1c9cxpu"><button class="tool-bar-button svelte-1c9cxpu">Encode</button> <div id="settings" class="svelte-1c9cxpu">Components: <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"> ✕ <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"></div> <div id="tools" class="svelte-1c9cxpu"><span> <!></span> | <span> <!></span></div></div></header> <main class="svelte-1c9cxpu"><noscript></noscript> <div id="items"></div></main> <footer class="svelte-1c9cxpu">Made with <a href="https://kit.svelte.dev/">Svelte</a> 5</footer></div>');function Vt(h,i){Fe(i,!0);const g=(o,r=dt)=>{var E=Bt(),j=M(E),T=M(j);b(j);var u=f(j,4),m=M(u);{var A=D=>{var R=Ot();X(()=>fe(R,"src",r().blurHashImageSrc)),S(D,R)};F(m,D=>{r().blurHashImageSrc&&D(A)})}var B=f(m,2);{var ce=D=>{var R=jt();S(D,R)};F(B,D=>{r().status==="failed"&&D(ce)})}b(u);var re=f(u,4),Y=M(re),me=f(M(Y),2);{var _e=D=>{var R=Lt(),de=ne(R);Ee(de);var ye=f(de,2);ye.__click=[Ht,C,r],X(()=>pt(de,r().blurHash)),S(D,R)},be=D=>{var R=oe("n/a");S(D,R)};F(me,D=>{r().blurHash!==""?D(_e):D(be,!1)})}b(Y);var ie=f(Y,2),Q=f(M(ie),2),Z=M(Q);b(Q),b(ie);var ue=f(ie,2),xe=f(M(ue),2),Je=M(xe,!0);b(xe),b(ue);var we=f(ue,2),he=f(M(we),2),Ne=M(he,!0);b(he);var ke=f(he,2);{var Ge=D=>{var R=Rt();Re(),S(D,R)};F(ke,D=>{r().usedCorsProxy&&D(Ge)})}b(we);var Le=f(we,2),Ke=f(M(Le),2);{var Qe=D=>{var R=At();const de=q(()=>r().endDate.getTime()-r().startDate.getTime()),ye=q(()=>r().startDate.toLocaleString()+"."+r().startDate.getMilliseconds()),Xe=q(()=>r().endDate.toLocaleString()+"."+r().endDate.getMilliseconds());var Ye=M(R);b(R),X(()=>{fe(R,"title",`${l(ye)??""} - ${l(Xe)??""}`),$(Ye,`${l(de)??""} ms`)}),S(D,R)};F(Ke,D=>{r().endDate&&D(Qe)})}b(Le),b(re),b(E),X(()=>{fe(T,"src",r().imageSrc),$(Z,`${r().xComponents??""} ✕ ${r().yComponents??""}`),fe(xe,"href",r().imageSrc),$(Je,r().imageSrc),vt(he,`task-status ${r().status??""} svelte-1c9cxpu`),$(Ne,r().status)}),mt("error",T,v),ht(T),Se(3,E,()=>ft,()=>({x:"50%"})),S(o,E)};let P=K(""),I=K(4),O=K(4),x=K(ge([])),w=K(!1),z=K(!1);const H=q(()=>l(x).filter(o=>o.status==="completed").length),U=q(()=>l(x).filter(o=>o.status==="failed").length),t=q(()=>l(P).trim()===""),e=q(()=>l(I)>0&&l(O)>0),a=q(()=>l(t)||!l(e));function n(o){const E=`job-${Math.random().toString(36).substring(2,8)}-${Date.now()}`,j=l(I),T=l(O),u=o.map((m,A)=>ge({id:`${E}-${A}`,url:m,xComponents:j,yComponents:T,blurHash:"",image:new Image,imageSrc:m,blurHashImage:new Image,blurHashImageSrc:"",startDate:new Date,endDate:null,usedCorsProxy:!1,status:"in-progress",error:null}));l(x).unshift(...u);for(const m of u)s(m)}async function s(o){const r=new Date;o.startDate=r;const E=o.url;let j=null,T=!1;const u=new Image;u.crossOrigin="Anonymous";try{await new Promise((Q,Z)=>{u.onload=Q,u.onerror=Z,u.src=E})}catch(Q){j=Q}if(j!=null){j=null;const Q=`https://corsproxy.io/?url=${encodeURIComponent(E)}`;try{await new Promise((Z,ue)=>{u.onload=Z,u.onerror=ue,u.src=Q}),T=!0}catch(Z){j=Z}}if(j!=null){o.status="failed",o.error=j,o.endDate=new Date;return}const m=64;let A=u.width,B=u.height;A>B?A>m&&(B=Math.round(B*m/A),A=m):B>m&&(A=Math.round(A*m/B),B=m);const ce=document.createElement("canvas");ce.width=A,ce.height=B;const re=ce.getContext("2d");if(re==null){o.status="failed",o.error=new Error("Failed to get 2d context"),o.endDate=new Date,o.usedCorsProxy=T;return}re.drawImage(u,0,0,u.width,u.height,0,0,A,B);const Y=re.getImageData(0,0,A,B),me=await Oe.encodePromise(Y.data,Y.width,Y.height,o.xComponents,o.yComponents),_e=await Oe.decodePromise(me,A,B,1),be=await Oe.getImageDataAsImageWithOnloadPromise(_e,A,B),ie=new Date;o.endDate=ie,o.blurHash=me,o.blurHashImageSrc=be.src,o.status="completed",o.usedCorsProxy=T}function v(o){o.target.classList.add("broken-image")}async function C(o,r){try{await navigator.clipboard.writeText(r)}catch(T){console.error("Failed to copy text: ",T);return}const E=o.target;E instanceof HTMLButtonElement&&(E.classList.add("success"),E.disabled=!0,await new Promise(T=>setTimeout(T,1e3)),E.classList.remove("success"),E.disabled=!1)}async function L(){const r=l(x).filter(m=>m.status==="completed").map(m=>({url:m.url,xComponents:m.xComponents,yComponents:m.yComponents,blurHash:m.blurHash})),E=JSON.stringify(r,null,2),j=new Blob([E],{type:"application/json"}),T=URL.createObjectURL(j),u=document.createElement("a");u.href=T,u.download="blur-hashes.json",u.click(),URL.revokeObjectURL(T),V(w,!0),await new Promise(m=>setTimeout(m,2e3)),V(w,!1)}var y=Ft();nt(o=>{var r=Tt();it.title="BlurHash Encoder",f(ne(r)),S(o,r)});var p=M(y),c=f(M(p),2);ut(c);var d=f(c,2),_=M(d);_.__click=[Et,P,n];var N=f(_,2),W=f(M(N));Ee(W);var k=f(W,2);Ee(k),b(N);var G=f(N,2),le=M(G),ve=M(le),ee=f(ve);{var te=o=>{var r=Ut();r.__click=L;var E=M(r);{var j=u=>{var m=oe("Exported");S(u,m)},T=u=>{var m=oe("📥 Export");S(u,m)};F(E,u=>{l(w)?u(j):u(T,!1)})}b(r),X(()=>{r.disabled=l(w),pe(r,"success",l(w))}),Se(3,r,()=>Ae),S(o,r)};F(ee,o=>{l(H)>0&&o(te)})}b(le);var ae=f(le,2),se=M(ae),We=f(se);{var qe=o=>{var r=zt();r.__click=[St,x,z];var E=M(r);{var j=u=>{var m=oe("Cleared");S(u,m)},T=u=>{var m=oe("❌ Clear");S(u,m)};F(E,u=>{l(z)?u(j):u(T,!1)})}b(r),X(()=>{r.disabled=l(z),pe(r,"success",l(z))}),Se(3,r,()=>Ae),S(o,r)};F(We,o=>{(l(U)>0||l(z))&&o(qe)})}b(ae),b(G),b(d),b(p);var je=f(p,2),He=f(M(je),2);lt(He,21,()=>l(x),o=>o.id,(o,r)=>{g(o,()=>l(r))}),b(He),b(je),Re(2),b(y),X(()=>{_.disabled=l(a),pe(W,"invalid",l(I)<=0),pe(k,"invalid",l(O)<=0),$(ve,`Completed: ${l(H)??""} `),$(se,`Failed: ${l(U)??""} `)}),Ce(c,()=>l(P),o=>V(P,o)),Ce(W,()=>l(I),o=>V(I,o)),Ce(k,()=>l(O),o=>V(O,o)),S(h,y),Ve()}ot(["click"]);const Wt=Object.freeze(Object.defineProperty({__proto__:null,component:Vt},Symbol.toStringTag,{value:"Module"}));export{It as _,Jt as a,gt as b,Pt as c,Xt as d,Yt as e,Zt as f,Vt as g,Mt as h,kt as m,Kt as n,Gt as r,Qt as s,Nt as v};
