import{p as ye,a as oe,u as Ce,b as Se,o as Oe,f as Y,i as J,c as L,d as xe,t as F,g as v,s as K,e as He,h as ve,j as le,k as ie,l as _,m as Z,n as ce,q as O,r as Me,v as X,w as ae,x as q,y as V,z as Te,L as Le,E as Re,A as Ae,B as je,C as Be,D as de,$ as Ue,F as ze,G as Ve,H as ue,I as fe,J as _e,K as Fe,M as re,N as We,O as Je,P as Ne,Q as Ge,R as Ke}from"./vendor.CkHFN55T.js";var pe;const Qe=((pe=globalThis.__sveltekit_18tewoq)==null?void 0:pe.base)??"/blur-hash-encoder";var be;const ft=((be=globalThis.__sveltekit_18tewoq)==null?void 0:be.assets)??Qe,_t="1728219469640",Xe="modulepreload",Ye=function(h,i){return new URL(h,i).href},we={},he=function(i,g,x){let f=Promise.resolve();if(g&&g.length>0){const w=document.getElementsByTagName("link"),p=document.querySelector("meta[property=csp-nonce]"),W=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));f=Promise.allSettled(g.map(H=>{if(H=Ye(H,x),H in we)return;we[H]=!0;const R=H.endsWith(".css"),a=R?'[rel="stylesheet"]':"";if(!!x)for(let n=w.length-1;n>=0;n--){const s=w[n];if(s.href===H&&(!R||s.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${H}"]${a}`))return;const t=document.createElement("link");if(t.rel=R?"stylesheet":Xe,R||(t.as="script"),t.crossOrigin="",t.href=H,W&&t.setAttribute("nonce",W),document.head.appendChild(t),R)return new Promise((n,s)=>{t.addEventListener("load",n),t.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${H}`)))})}))}function M(w){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=w,window.dispatchEvent(p),!p.defaultPrevented)throw w}return f.then(w=>{for(const p of w||[])p.status==="rejected"&&M(p.reason);return i().catch(M)})},wt={};var Ze=F('<div id="svelte-announcer" aria-live="assertive" aria-atomic="true" style="position: absolute; left: 0; top: 0; clip: rect(0 0 0 0); clip-path: inset(50%); overflow: hidden; white-space: nowrap; width: 1px; height: 1px"><!></div>'),ke=F("<!> <!>",1);function $e(h,i){ye(i,!0);let g=oe(i,"components",23,()=>[]),x=oe(i,"data_0",3,null),f=oe(i,"data_1",3,null);Ce(()=>i.stores.page.set(i.page)),Se(()=>{i.stores,i.page,i.constructors,g(),i.form,x(),f(),i.stores.page.notify()});let M=Z(!1),w=Z(!1),p=Z(null);Oe(()=>{const e=i.stores.page.subscribe(()=>{v(M)&&(K(w,!0),He().then(()=>{K(p,ve(document.title||"untitled page"))}))});return K(M,!0),e});const W=V(()=>i.constructors[1]);var H=ke(),R=Y(H);J(R,()=>i.constructors[1],e=>{var t=le();const n=V(()=>i.constructors[0]);var s=Y(t);ie(s,()=>v(n),(c,b)=>{ce(b(c,{get data(){return x()},get form(){return i.form},children:(m,E)=>{var u=le(),d=Y(u);ie(d,()=>v(W),(l,r)=>{ce(r(l,{get data(){return f()},get form(){return i.form}}),o=>g()[1]=o,()=>{var o;return(o=g())==null?void 0:o[1]})}),L(m,u)},$$slots:{default:!0}}),m=>g()[0]=m,()=>{var m;return(m=g())==null?void 0:m[0]})}),L(e,t)},e=>{var t=le();const n=V(()=>i.constructors[0]);var s=Y(t);ie(s,()=>v(n),(c,b)=>{ce(b(c,{get data(){return x()},get form(){return i.form}}),m=>g()[0]=m,()=>{var m;return(m=g())==null?void 0:m[0]})}),L(e,t)});var a=_(R,2);J(a,()=>v(M),e=>{var t=Ze(),n=O(t);J(n,()=>v(w),s=>{var c=Me();X(()=>ae(c,v(p))),L(s,c)}),q(t),L(e,t)}),L(h,H),xe()}const pt=Te($e),bt=[()=>he(()=>Promise.resolve().then(()=>tt),void 0,import.meta.url),()=>he(()=>Promise.resolve().then(()=>at),void 0,import.meta.url),()=>he(()=>Promise.resolve().then(()=>vt),void 0,import.meta.url)],yt=[],xt={"/":[2]},Mt={handleError:({error:h})=>{console.error(h)},reroute:()=>{}},et=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),tt=Object.freeze(Object.defineProperty({__proto__:null,component:Le,universal:et},Symbol.toStringTag,{value:"Module"})),at=Object.freeze(Object.defineProperty({__proto__:null,component:Re},Symbol.toStringTag,{value:"Module"})),me=function(h){const i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],g=a=>{let e=0;for(let t=0;t<a.length;t++){const n=a[t];e=83*e+i.indexOf(n)}return e},x=(a,e)=>{var t="";for(let n=1;n<=e;n++){let s=Math.floor(a)/Math.pow(83,e-n)%83;t+=i[Math.floor(s)]}return t},f=a=>{let e=a/255;return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},M=a=>{let e=Math.max(0,Math.min(1,a));return e<=.0031308?Math.round(12.92*e*255+.5):Math.round(255*(1.055*Math.pow(e,.4166666666666667)-.055)+.5)},w=(a,e)=>(t=>t<0?-1:1)(a)*Math.pow(Math.abs(a),e),p=a=>{if(!a||a.length<6)throw new Error("The blurhash string must be at least 6 characters");const e=g(a[0]),t=Math.floor(e/9)+1,n=e%9+1;if(a.length!==4+2*n*t)throw new Error(`blurhash length mismatch: length is ${a.length} but it should be ${4+2*n*t}`)},W=a=>{const e=a>>8&255,t=255&a;return[f(a>>16),f(e),f(t)]},H=(a,e)=>{const t=Math.floor(a/361),n=Math.floor(a/19)%19,s=a%19;return[w((t-9)/9,2)*e,w((n-9)/9,2)*e,w((s-9)/9,2)*e]},R=(a,e,t,n)=>{let s=0,c=0,b=0;const m=4*e;for(let u=0;u<e;u++)for(let d=0;d<t;d++){const l=n(u,d);s+=l*f(a[4*u+0+d*m]),c+=l*f(a[4*u+1+d*m]),b+=l*f(a[4*u+2+d*m])}let E=1/(e*t);return[s*E,c*E,b*E]};return h.decodePromise=(a,e,t,n=1)=>new Promise((s,c)=>{s(h.decode(a,e,t,n))}),h.decode=(a,e,t,n=1)=>{p(a),n|=1;const s=g(a[0]),c=Math.floor(s/9)+1,b=s%9+1,m=(g(a[1])+1)/166,E=new Array(b*c);for(let l=0;l<E.length;l++)if(l===0){const r=g(a.substring(2,6));E[l]=W(r)}else{const r=g(a.substring(4+2*l,6+2*l));E[l]=H(r,m*n)}const u=4*e,d=new Uint8ClampedArray(u*t);for(let l=0;l<t;l++)for(let r=0;r<e;r++){let o=0,y=0,P=0;for(let S=0;S<c;S++)for(let I=0;I<b;I++){const j=Math.cos(Math.PI*r*I/e)*Math.cos(Math.PI*l*S/t);let U=E[I+S*b];o+=U[0]*j,y+=U[1]*j,P+=U[2]*j}let C=M(o),D=M(y),A=M(P);d[4*r+0+l*u]=C,d[4*r+1+l*u]=D,d[4*r+2+l*u]=A,d[4*r+3+l*u]=255}return d},h.encodePromise=(a,e,t,n,s)=>new Promise((c,b)=>{c(h.encode(a,e,t,n,s))}),h.encode=(a,e,t,n,s)=>{if(n<1||n>9||s<1||s>9)throw new Error("BlurHash must have between 1 and 9 components");if(e*t*4!==a.length)throw new Error("Width and height must match the pixels array");let c=[];for(let d=0;d<s;d++)for(let l=0;l<n;l++){const r=l==0&&d==0?1:2,o=R(a,e,t,(y,P)=>r*Math.cos(Math.PI*l*y/e)*Math.cos(Math.PI*d*P/t));c.push(o)}const b=c[0],m=c.slice(1);let E,u="";if(u+=x(n-1+9*(s-1),1),m.length>0){let d=Math.max(...m.map(r=>Math.max(...r))),l=Math.floor(Math.max(0,Math.min(82,Math.floor(166*d-.5))));E=(l+1)/166,u+=x(l,1)}else E=1,u+=x(0,1);return u+=x((d=>(M(d[0])<<16)+(M(d[1])<<8)+M(d[2]))(b),4),m.forEach(d=>{u+=x(((l,r)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*w(l[0]/r,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*w(l[1]/r,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*w(l[2]/r,.5)+9.5)))))(d,E),2)}),u},h.getImageData=a=>{const e=a.width,t=a.height,n=document.createElement("canvas"),s=n.getContext("2d");return n.width=e,n.height=t,s.width=e,s.height=t,s.drawImage(a,0,0),s.getImageData(0,0,e,t).data},h.drawImageDataOnNewCanvas=(a,e,t)=>{const n=document.createElement("canvas"),s=n.getContext("2d");return n.width=e,n.height=t,s.width=e,s.height=t,s.putImageData(new ImageData(a,e,t),0,0),n},h.getImageDataAsImageWithOnloadPromise=(a,e,t)=>new Promise((n,s)=>{h.getImageDataAsImage(a,e,t,(c,b)=>{n(b)})}),h.getImageDataAsImage=(a,e,t,n)=>{const s=h.drawImageDataOnNewCanvas(a,e,t).toDataURL(),c=new Image(e,t);return c.onload=b=>n(b,c),c.width=e,c.height=t,c.src=s,c},h}({});async function rt(h,i,g){const x=v(i).split(/\r?\n/).filter(f=>f.trim()!=="");await new Promise(f=>setTimeout(f,0)),K(i,""),g(x)}var nt=ze('<script src="analytics.js"><\/script><!---->',1),st=F('<img alt="BlurHash" class="svelte-4newrq">'),ot=F('<span class="not-available svelte-4newrq">n/a</span>'),lt=(h,i,g)=>i(h,g().blurHash),it=F('<input class="blur-hash svelte-4newrq" type="text" title="Copy" readonly=""> <button class="copy-button svelte-4newrq">⧉</button>',1),ct=F('| <span class="cors-tag svelte-4newrq" title="Used CORS proxy">CORS</span>',1),dt=F("<span> </span>"),ut=F('<div class="item svelte-4newrq"><div class="thumbnail image-thumbnail svelte-4newrq"><img alt="Original" class="svelte-4newrq"></div> <div class="spacer svelte-4newrq"></div> <div class="thumbnail blur-hash-thumbnail svelte-4newrq"><!> <!></div> <div class="spacer svelte-4newrq"></div> <div class="info svelte-4newrq"><div class="blur-hash-section svelte-4newrq"><span class="label svelte-4newrq">BlurHash:</span> <!></div> <div class="truncated svelte-4newrq"><span class="label svelte-4newrq">Components:</span> <span> </span></div> <div class="truncated svelte-4newrq"><span class="label svelte-4newrq">URL:</span> <a target="_blank"> </a></div> <div class="truncated svelte-4newrq"><span class="label svelte-4newrq">Status:</span> <span> </span> <!></div> <div class="truncated svelte-4newrq"><span class="label svelte-4newrq">Duration:</span> <!></div></div></div>'),ht=F('<div id="page-layout" class="svelte-4newrq"><header class="svelte-4newrq"><h1>BlurHash Encoder</h1> <textarea id="input" rows="4" placeholder="Enter image URLs" class="svelte-4newrq"></textarea> <div><button id="encode-button" class="svelte-4newrq">Encode</button> Components: <input class="components-input svelte-4newrq" type="number" min="1" max="10"> ✕ <input class="components-input svelte-4newrq" type="number" min="1" max="10"></div></header> <main class="svelte-4newrq"><noscript></noscript> <div id="items"></div></main> <footer class="svelte-4newrq">Footer</footer></div>');function mt(h,i){ye(i,!0);const g=(r,o=Ke)=>{var y=ut(),P=O(y),C=O(P);q(P);var D=_(P,4),A=O(D);J(A,()=>o().blurHashImageSrc,B=>{var T=st();X(()=>re(T,"src",o().blurHashImageSrc)),L(B,T)});var S=_(A,2);J(S,()=>o().status==="failed",B=>{var T=ot();L(B,T)}),q(D);var I=_(D,4),j=O(I),U=_(O(j),2);J(U,()=>o().blurHash!=="",B=>{var T=it(),te=Y(T);ue(te);var se=_(te,2);se.__click=[lt,t,o],X(()=>We(te,o().blurHash)),L(B,T)},B=>{var T=Me("n/a");L(B,T)}),q(j);var N=_(j,2),k=_(O(N),2),ne=O(k);q(k),q(N);var $=_(N,2),ee=_(O($),2),G=O(ee);q(ee),q($);var z=_($,2),Q=_(O(z),2),Pe=O(Q);q(Q);var De=_(Q,2);J(De,()=>o().usedCorsProxy,B=>{var T=ct();fe(),L(B,T)}),q(z);var ge=_(z,2),Ie=_(O(ge),2);J(Ie,()=>o().endDate,B=>{var T=dt();const te=V(()=>o().endDate.getTime()-o().startDate.getTime()),se=V(()=>o().startDate.toLocaleString()+"."+o().startDate.getMilliseconds()),qe=V(()=>o().endDate.toLocaleString()+"."+o().endDate.getMilliseconds());var Ee=O(T);q(T),X(()=>{re(T,"title",`${v(se)??""} - ${v(qe)??""}`),ae(Ee,`${v(te)??""} ms`)}),L(B,T)}),q(ge),q(I),q(y),X(()=>{re(C,"src",o().imageSrc),ae(ne,`${o().xComponents??""} ✕ ${o().yComponents??""}`),re(ee,"href",o().imageSrc),ae(G,o().imageSrc),Je(Q,`task-status ${o().status??""} svelte-4newrq`),ae(Pe,o().status)}),Ne("error",C,e),Ge(C),L(r,y)};let x=Z(""),f=Z(4),M=Z(4),w=ve([]);const p=V(()=>v(x).trim()===""),W=V(()=>v(f)>0&&v(M)>0),H=V(()=>v(p)||!v(W));function R(r){const o=v(f),y=v(M),P=r.map(C=>ve({url:C,xComponents:o,yComponents:y,blurHash:"",image:new Image,imageSrc:C,blurHashImage:new Image,blurHashImageSrc:"",startDate:new Date,endDate:null,usedCorsProxy:!1,status:"in-progress",error:null}));w.unshift(...P);for(const C of P)a(C)}async function a(r){const o=new Date;r.startDate=o;const y=r.url;let P=null,C=!1;const D=new Image;D.crossOrigin="Anonymous";try{await new Promise((G,z)=>{D.onload=G,D.onerror=z,D.src=y})}catch(G){P=G}if(P!=null){P=null;const G=`https://corsproxy.io/?${encodeURIComponent(y)}`;try{await new Promise((z,Q)=>{D.onload=z,D.onerror=Q,D.src=G}),C=!0}catch(z){P=z}}if(P!=null){r.status="failed",r.error=P,r.endDate=new Date;return}const A=64;let S=D.width,I=D.height;S>I?S>A&&(I=Math.round(I*A/S),S=A):I>A&&(S=Math.round(S*A/I),I=A);const j=document.createElement("canvas");j.width=S,j.height=I;const U=j.getContext("2d");if(U==null){r.status="failed",r.error=new Error("Failed to get 2d context"),r.endDate=new Date,r.usedCorsProxy=C;return}U.drawImage(D,0,0,D.width,D.height,0,0,S,I);const N=U.getImageData(0,0,S,I),k=await me.encodePromise(N.data,N.width,N.height,r.xComponents,r.yComponents),ne=await me.decodePromise(k,S,I,1),$=await me.getImageDataAsImageWithOnloadPromise(ne,S,I),ee=new Date;r.endDate=ee,r.blurHash=k,r.blurHashImageSrc=$.src,r.status="completed",r.usedCorsProxy=C}function e(r){r.target.classList.add("broken-image")}async function t(r,o){try{await navigator.clipboard.writeText(o)}catch(C){console.error("Failed to copy text: ",C);return}const y=r.target;y instanceof HTMLButtonElement&&(y.classList.add("success"),y.disabled=!0,await new Promise(C=>setTimeout(C,1e3)),y.classList.remove("success"),y.disabled=!1)}var n=ht();je(r=>{var o=nt();Ue.title="BlurHash Encoder";var y=_(Y(o));L(r,o)});var s=O(n),c=_(O(s),2);Ve(c);var b=_(c,2),m=O(b);m.__click=[rt,x,R];var E=_(m,2);ue(E);var u=_(E,2);ue(u),q(b),q(s);var d=_(s,2),l=_(O(d),2);Be(l,21,()=>w,Fe,(r,o)=>{g(r,()=>v(o))}),q(l),q(d),fe(2),q(n),X(()=>{m.disabled=v(H),_e(E,"invalid",v(f)<=0),_e(u,"invalid",v(M)<=0)}),de(c,()=>v(x),r=>K(x,r)),de(E,()=>v(f),r=>K(f,r)),de(u,()=>v(M),r=>K(M,r)),L(h,n),xe()}Ae(["click"]);const vt=Object.freeze(Object.defineProperty({__proto__:null,component:mt},Symbol.toStringTag,{value:"Module"}));export{et as _,ft as a,Qe as b,mt as c,xt as d,Mt as h,wt as m,bt as n,pt as r,yt as s,_t as v};
