import{t as G,a as U,e as pa,d as he}from"../chunks/qAS4O2O_.js";import{C as ma,m as ga,q as Te,n as V,D as xa,p as ba,g as w,ag as wa,H as ya,r as Ve,t as Ae,y as _e,a7 as Ma,v as Ze,w as ea,x as Ia,as as Se,aa,h as ye,at as Ca,aj as Ea,s as qe,au as Da,av as Ta,X as Aa,aw as Sa,A as Pa,ax as Ha,ay as Na,a4 as La,k as Ra,az as Oa,aA as $a,j as Ba,aB as Fa,E as Ua,aC as ka,aD as Va,ac as qa,a as ta,aE as ja,aF as Wa,a1 as za,z as ie,Y as je,Z as We,_ as Ga,aG as Ya,ad as Ja,O as Ka,aq as ne,R as P,P as Z,Q as Xa,W as T,e as W,aH as Qa,B as ze,V as S,M as J,aI as Ge}from"../chunks/CmoOLJhX.js";import{a as Za,b as et,w as at,l as tt,d as rt,c as st,r as nt,s as oe,e as ot,f as it}from"../chunks/Bxu7uXIm.js";import{p as $e,i as j}from"../chunks/DFwoAKZt.js";function lt(e,a,r,l){for(var i=[],f=a.length,v=0;v<f;v++)Ta(a[v].e,i,!0);var y=f>0&&i.length===0&&r!==null;if(y){var E=r.parentNode;Aa(E),E.append(r),l.clear(),K(e,a[0].prev,a[f-1].next)}Sa(i,()=>{for(var x=0;x<f;x++){var u=a[x];y||(l.delete(u.k),K(e,u.prev,u.next)),Pa(u.e,!y)}})}function ct(e,a,r,l,i,f=null){var v=e,y={flags:a,items:new Map,first:null};{var E=e;v=V?Te(xa(E)):E.appendChild(ma())}V&&ba();var x=null,u=!1,s=wa(()=>{var t=r();return Ra(t)?t:t==null?[]:aa(t)});ga(()=>{var t=w(s),n=t.length;if(u&&n===0)return;u=n===0;let o=!1;if(V){var c=v.data===ya;c!==(n===0)&&(v=Ve(),Te(v),Ae(!1),o=!0)}if(V){for(var _=null,p,I=0;I<n;I++){if(_e.nodeType===8&&_e.data===Ma){v=_e,o=!0,Ae(!1);break}var A=t[I],M=l(A,I);p=ra(_e,y,_,null,A,M,I,i,a,r),y.items.set(M,p),_=p}n>0&&Te(Ve())}V||ut(t,y,v,i,a,l,r),f!==null&&(n===0?x?Ze(x):x=ea(()=>f(v)):x!==null&&Ia(x,()=>{x=null})),o&&Ae(!0),w(s)}),V&&(v=_e)}function ut(e,a,r,l,i,f,v){var y=e.length,E=a.items,x=a.first,u=x,s,t=null,n=[],o=[],c,_,p,I;for(I=0;I<y;I+=1){if(c=e[I],_=f(c,I),p=E.get(_),p===void 0){var A=u?u.e.nodes_start:r;t=ra(A,a,t,t===null?a.first:t.next,c,_,I,l,i,v),E.set(_,t),n=[],o=[],u=t.next;continue}if(vt(p,c,I),p.e.f&Se&&Ze(p.e),p!==u){if(s!==void 0&&s.has(p)){if(n.length<o.length){var M=o[0],m;t=M.prev;var g=n[0],D=n[n.length-1];for(m=0;m<n.length;m+=1)Ye(n[m],M,r);for(m=0;m<o.length;m+=1)s.delete(o[m]);K(a,g.prev,D.next),K(a,t,g),K(a,D,M),u=M,t=D,I-=1,n=[],o=[]}else s.delete(p),Ye(p,u,r),K(a,p.prev,p.next),K(a,p,t===null?a.first:t.next),K(a,t,p),t=p;continue}for(n=[],o=[];u!==null&&u.k!==_;)u.e.f&Se||(s??(s=new Set)).add(u),o.push(u),u=u.next;if(u===null)continue;p=u}n.push(p),t=p,u=p.next}if(u!==null||s!==void 0){for(var B=s===void 0?[]:aa(s);u!==null;)u.e.f&Se||B.push(u),u=u.next;var O=B.length;if(O>0){var q=y===0?r:null;lt(a,B,q,E)}}ye.first=a.first&&a.first.e,ye.last=t&&t.e}function vt(e,a,r,l){Ca(e.v,a),e.i=r}function ra(e,a,r,l,i,f,v,y,E,x){var u=(E&Ha)!==0,s=(E&Na)===0,t=u?s?Ea(i):qe(i):i,n=E&Da?qe(v):v,o={i:n,v:t,k:f,a:null,e:null,prev:r,next:l};try{return o.e=ea(()=>y(e,t,n,x),V),o.e.prev=r&&r.e,o.e.next=l&&l.e,r===null?a.first=o:(r.next=o,r.e.next=o.e),l!==null&&(l.prev=o,l.e.prev=o.e),o}finally{}}function Ye(e,a,r){for(var l=e.next?e.next.e.nodes_start:r,i=a?a.e.nodes_start:r,f=e.e.nodes_start;f!==l;){var v=La(f);i.before(f),f=v}}function K(e,a,r){a===null?e.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function Pe(e){if(V){var a=!1,r=()=>{if(!a){if(a=!0,e.hasAttribute("value")){var l=e.value;le(e,"value",null),e.value=l}if(e.hasAttribute("checked")){var i=e.checked;le(e,"checked",null),e.checked=i}}};e.__on_r=r,Oa(r),Za()}}function ft(e,a){var r=e.__attributes??(e.__attributes={});r.value===(r.value=a??void 0)||e.value===a&&(a!==0||e.nodeName!=="PROGRESS")||(e.value=a??"")}function le(e,a,r,l){var i=e.__attributes??(e.__attributes={});V&&(i[a]=e.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&e.nodeName==="LINK")||i[a]!==(i[a]=r)&&(a==="style"&&"__styles"in e&&(e.__styles={}),a==="loading"&&(e[$a]=r),r==null?e.removeAttribute(a):typeof r!="string"&&dt(e).includes(a)?e[a]=r:e.setAttribute(a,r))}var Je=new Map;function dt(e){var a=Je.get(e.nodeName);if(a)return a;Je.set(e.nodeName,a=[]);for(var r,l=e,i=Element.prototype;i!==l;){r=Fa(l);for(var f in r)r[f].set&&a.push(f);l=Ba(l)}return a}function ht(e,a,r){var l=e.__className,i=_t(a);V&&e.className===i?e.__className=i:(l!==i||V&&e.className!==i)&&(a==null?e.removeAttribute("class"):e.className=i,e.__className=i)}function _t(e,a){return(e??"")+""}function be(e,a,r){if(r){if(e.classList.contains(a))return;e.classList.add(a)}else{if(!e.classList.contains(a))return;e.classList.remove(a)}}const pt=()=>performance.now(),z={tick:e=>requestAnimationFrame(e),now:()=>pt(),tasks:new Set};function sa(){const e=z.now();z.tasks.forEach(a=>{a.c(e)||(z.tasks.delete(a),a.f())}),z.tasks.size!==0&&z.tick(sa)}function mt(e){let a;return z.tasks.size===0&&z.tick(sa),{promise:new Promise(r=>{z.tasks.add(a={c:e,f:r})}),abort(){z.tasks.delete(a)}}}function we(e,a){at(()=>{e.dispatchEvent(new CustomEvent(a))})}function gt(e){if(e==="float")return"cssFloat";if(e==="offset")return"cssOffset";if(e.startsWith("--"))return e;const a=e.split("-");return a.length===1?a[0]:a[0]+a.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function Ke(e){const a={},r=e.split(";");for(const l of r){const[i,f]=l.split(":");if(!i||f===void 0)break;const v=gt(i.trim());a[v]=f.trim()}return a}const xt=e=>e;function He(e,a,r,l){var i=(e&ja)!==0,f="both",v,y=a.inert,E=a.style.overflow,x,u;function s(){var _=Ga,p=ye;je(null),We(null);try{return v??(v=r()(a,(l==null?void 0:l())??{},{direction:f}))}finally{je(_),We(p)}}var t={is_global:i,in(){a.inert=y,we(a,"introstart"),x=Be(a,s(),u,1,()=>{we(a,"introend"),x==null||x.abort(),x=v=void 0,a.style.overflow=E})},out(_){a.inert=!0,we(a,"outrostart"),u=Be(a,s(),x,0,()=>{we(a,"outroend"),_==null||_()})},stop:()=>{x==null||x.abort(),u==null||u.abort()}},n=ye;if((n.transitions??(n.transitions=[])).push(t),et){var o=i;if(!o){for(var c=n.parent;c&&c.f&Ua;)for(;(c=c.parent)&&!(c.f&ka););o=!c||(c.f&Va)!==0}o&&qa(()=>{ta(()=>t.in())})}}function Be(e,a,r,l,i){var f=l===1;if(Wa(a)){var v,y=!1;return za(()=>{if(!y){var _=a({direction:f?"in":"out"});v=Be(e,_,r,l,i)}}),{abort:()=>{y=!0,v==null||v.abort()},deactivate:()=>v.deactivate(),reset:()=>v.reset(),t:()=>v.t()}}if(r==null||r.deactivate(),!(a!=null&&a.duration))return i(),{abort:ie,deactivate:ie,reset:ie,t:()=>l};const{delay:E=0,css:x,tick:u,easing:s=xt}=a;var t=[];if(f&&r===void 0&&(u&&u(0,1),x)){var n=Ke(x(0,1));t.push(n,n)}var o=()=>1-l,c=e.animate(t,{duration:E});return c.onfinish=()=>{var _=(r==null?void 0:r.t())??1-l;r==null||r.abort();var p=l-_,I=a.duration*Math.abs(p),A=[];if(I>0){var M=!1;if(x)for(var m=Math.ceil(I/16.666666666666668),g=0;g<=m;g+=1){var D=_+p*s(g/m),B=Ke(x(D,1-D));A.push(B),M||(M=B.overflow==="hidden")}M&&(e.style.overflow="hidden"),o=()=>{var O=c.currentTime;return _+p*s(O/I)},u&&mt(()=>{if(c.playState!=="running")return!1;var O=o();return u(O,1-O),!0})}c=e.animate(A,{duration:I,fill:"forwards"}),c.onfinish=()=>{o=()=>l,u==null||u(l,1-l),i()}},{abort:()=>{c&&(c.cancel(),c.effect=null,c.onfinish=ie)},deactivate:()=>{i=ie},reset:()=>{l===0&&(u==null||u(1,0))},t:()=>o()}}function Ne(e,a,r=a){var l=Ya();tt(e,"input",i=>{var f=i?e.defaultValue:e.value;if(f=Le(e)?Re(f):f,r(f),l&&f!==(f=a())){var v=e.selectionStart,y=e.selectionEnd;e.value=f??"",y!==null&&(e.selectionStart=v,e.selectionEnd=Math.min(y,e.value.length))}}),(V&&e.defaultValue!==e.value||ta(a)==null&&e.value)&&r(Le(e)?Re(e.value):e.value),Ja(()=>{var i=a();Le(e)&&i===Re(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function Le(e){var a=e.type;return a==="number"||a==="range"}function Re(e){return e===""?null:+e}function na(e){const a=e-1;return a*a*a+1}function Xe(e){const a=typeof e=="string"&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return a?[parseFloat(a[1]),a[2]||"px"]:[e,"px"]}function bt(e,{delay:a=0,duration:r=400,easing:l=na,x:i=0,y:f=0,opacity:v=0}={}){const y=getComputedStyle(e),E=+y.opacity,x=y.transform==="none"?"":y.transform,u=E*(1-v),[s,t]=Xe(i),[n,o]=Xe(f);return{delay:a,duration:r,easing:l,css:(c,_)=>`
			transform: ${x} translate(${(1-c)*s}${t}, ${(1-c)*n}${o});
			opacity: ${E-u*_}`}}function Qe(e,{delay:a=0,duration:r=400,easing:l=na,start:i=0,opacity:f=0}={}){const v=getComputedStyle(e),y=+v.opacity,E=v.transform==="none"?"":v.transform,x=1-i,u=y*(1-f);return{delay:a,duration:r,easing:l,css:(s,t)=>`
			transform: ${E} scale(${1-x*t});
			opacity: ${y-u*t}
		`}}const Oe=function(e){const a=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],r=s=>{let t=0;for(let n=0;n<s.length;n++){const o=s[n];t=83*t+a.indexOf(o)}return t},l=(s,t)=>{var n="";for(let o=1;o<=t;o++){let c=Math.floor(s)/Math.pow(83,t-o)%83;n+=a[Math.floor(c)]}return n},i=s=>{let t=s/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)},f=s=>{let t=Math.max(0,Math.min(1,s));return t<=.0031308?Math.round(12.92*t*255+.5):Math.round(255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5)},v=(s,t)=>(n=>n<0?-1:1)(s)*Math.pow(Math.abs(s),t),y=s=>{if(!s||s.length<6)throw new Error("The blurhash string must be at least 6 characters");const t=r(s[0]),n=Math.floor(t/9)+1,o=t%9+1;if(s.length!==4+2*o*n)throw new Error(`blurhash length mismatch: length is ${s.length} but it should be ${4+2*o*n}`)},E=s=>{const t=s>>8&255,n=255&s;return[i(s>>16),i(t),i(n)]},x=(s,t)=>{const n=Math.floor(s/361),o=Math.floor(s/19)%19,c=s%19;return[v((n-9)/9,2)*t,v((o-9)/9,2)*t,v((c-9)/9,2)*t]},u=(s,t,n,o)=>{let c=0,_=0,p=0;const I=4*t;for(let M=0;M<t;M++)for(let m=0;m<n;m++){const g=o(M,m);c+=g*i(s[4*M+0+m*I]),_+=g*i(s[4*M+1+m*I]),p+=g*i(s[4*M+2+m*I])}let A=1/(t*n);return[c*A,_*A,p*A]};return e.decodePromise=(s,t,n,o=1)=>new Promise((c,_)=>{c(e.decode(s,t,n,o))}),e.decode=(s,t,n,o=1)=>{y(s),o|=1;const c=r(s[0]),_=Math.floor(c/9)+1,p=c%9+1,I=(r(s[1])+1)/166,A=new Array(p*_);for(let g=0;g<A.length;g++)if(g===0){const D=r(s.substring(2,6));A[g]=E(D)}else{const D=r(s.substring(4+2*g,6+2*g));A[g]=x(D,I*o)}const M=4*t,m=new Uint8ClampedArray(M*n);for(let g=0;g<n;g++)for(let D=0;D<t;D++){let B=0,O=0,q=0;for(let ee=0;ee<_;ee++)for(let ae=0;ae<p;ae++){const te=Math.cos(Math.PI*D*ae/t)*Math.cos(Math.PI*g*ee/n);let re=A[ae+ee*p];B+=re[0]*te,O+=re[1]*te,q+=re[2]*te}let pe=f(B),ce=f(O),me=f(q);m[4*D+0+g*M]=pe,m[4*D+1+g*M]=ce,m[4*D+2+g*M]=me,m[4*D+3+g*M]=255}return m},e.encodePromise=(s,t,n,o,c)=>new Promise((_,p)=>{_(e.encode(s,t,n,o,c))}),e.encode=(s,t,n,o,c)=>{if(o<1||o>9||c<1||c>9)throw new Error("BlurHash must have between 1 and 9 components");if(t*n*4!==s.length)throw new Error("Width and height must match the pixels array");let _=[];for(let m=0;m<c;m++)for(let g=0;g<o;g++){const D=g==0&&m==0?1:2,B=u(s,t,n,(O,q)=>D*Math.cos(Math.PI*g*O/t)*Math.cos(Math.PI*m*q/n));_.push(B)}const p=_[0],I=_.slice(1);let A,M="";if(M+=l(o-1+9*(c-1),1),I.length>0){let m=Math.max(...I.map(D=>Math.max(...D))),g=Math.floor(Math.max(0,Math.min(82,Math.floor(166*m-.5))));A=(g+1)/166,M+=l(g,1)}else A=1,M+=l(0,1);return M+=l((m=>(f(m[0])<<16)+(f(m[1])<<8)+f(m[2]))(p),4),I.forEach(m=>{M+=l(((g,D)=>19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*v(g[0]/D,.5)+9.5))))*19+19*Math.floor(Math.max(0,Math.min(18,Math.floor(9*v(g[1]/D,.5)+9.5))))+Math.floor(Math.max(0,Math.min(18,Math.floor(9*v(g[2]/D,.5)+9.5)))))(m,A),2)}),M},e.getImageData=s=>{const t=s.width,n=s.height,o=document.createElement("canvas"),c=o.getContext("2d");return o.width=t,o.height=n,c.width=t,c.height=n,c.drawImage(s,0,0),c.getImageData(0,0,t,n).data},e.drawImageDataOnNewCanvas=(s,t,n)=>{const o=document.createElement("canvas"),c=o.getContext("2d");return o.width=t,o.height=n,c.width=t,c.height=n,c.putImageData(new ImageData(s,t,n),0,0),o},e.getImageDataAsImageWithOnloadPromise=(s,t,n)=>new Promise((o,c)=>{e.getImageDataAsImage(s,t,n,(_,p)=>{o(p)})}),e.getImageDataAsImage=(s,t,n,o)=>{const c=e.drawImageDataOnNewCanvas(s,t,n).toDataURL(),_=new Image(t,n);return _.onload=p=>o(p,_),_.width=t,_.height=n,_.src=c,_},e}({});async function wt(e,a,r){const l=w(a).split(/\r?\n/).filter(i=>i.trim()!=="");await new Promise(i=>setTimeout(i,0)),W(a,""),r(l)}async function yt(e,a,r){W(a,$e(w(a).filter(l=>l.status!=="failed"))),W(r,!0),await new Promise(l=>setTimeout(l,2e3)),W(r,!1)}var Mt=pa('<script src="analytics.js"><\/script><!---->',1),It=G('<img alt="BlurHash" class="svelte-1c9cxpu">'),Ct=G('<span class="not-available svelte-1c9cxpu">n/a</span>'),Et=(e,a,r)=>a(e,r().blurHash),Dt=G('<input class="blur-hash svelte-1c9cxpu" type="text" title="Copy" readonly=""> <button class="copy-button svelte-1c9cxpu">⧉</button>',1),Tt=G('| <span class="cors-tag svelte-1c9cxpu" title="Used CORS proxy">CORS</span>',1),At=G("<span> </span>"),St=G('<div class="item svelte-1c9cxpu"><div class="thumbnail image-thumbnail svelte-1c9cxpu"><img alt="Original" class="svelte-1c9cxpu"></div> <div class="spacer svelte-1c9cxpu"></div> <div class="thumbnail blur-hash-thumbnail svelte-1c9cxpu"><!> <!></div> <div class="spacer svelte-1c9cxpu"></div> <div class="info svelte-1c9cxpu"><div class="blur-hash-section svelte-1c9cxpu"><span class="label svelte-1c9cxpu">BlurHash:</span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Components:</span> <span> </span></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">URL:</span> <a target="_blank"> </a></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Status:</span> <span> </span> <!></div> <div class="truncated svelte-1c9cxpu"><span class="label svelte-1c9cxpu">Duration:</span> <!></div></div></div>'),Pt=G('<button class="tool-bar-button svelte-1c9cxpu" title="Export completed tasks"><!></button>'),Ht=G('<button class="tool-bar-button svelte-1c9cxpu" title="Clear failed tasks"><!></button>'),Nt=G('<div id="page-layout" class="svelte-1c9cxpu"><header class="svelte-1c9cxpu"><h1>BlurHash Encoder</h1> <textarea id="input" rows="4" placeholder="Enter image URLs" class="svelte-1c9cxpu"></textarea> <div id="tool-bar" class="svelte-1c9cxpu"><button class="tool-bar-button svelte-1c9cxpu">Encode</button> <div id="settings" class="svelte-1c9cxpu">Components: <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"> ✕ <input class="components-input svelte-1c9cxpu" type="number" min="1" max="10"></div> <div id="tools" class="svelte-1c9cxpu"><span> <!></span> | <span> <!></span></div></div></header> <main class="svelte-1c9cxpu"><noscript></noscript> <div id="items"></div></main> <footer class="svelte-1c9cxpu">Made with <a href="https://kit.svelte.dev/">Svelte</a> 5</footer></div>');function Bt(e,a){Ka(a,!0);const r=(h,d=ie)=>{var N=St(),R=P(N),L=P(R);S(R);var b=T(R,4),C=P(b);{var F=H=>{var $=It();Z(()=>le($,"src",d().blurHashImageSrc)),U(H,$)};j(C,H=>{d().blurHashImageSrc&&H(F)})}var k=T(C,2);{var ue=H=>{var $=Ct();U(H,$)};j(k,H=>{d().status==="failed"&&H(ue)})}S(b);var se=T(b,4),X=P(se),ge=T(P(X),2);{var Me=H=>{var $=Dt(),de=ze($);Pe(de);var De=T(de,2);De.__click=[Et,p,d],Z(()=>ft(de,d().blurHash)),U(H,$)},Ie=H=>{var $=he("n/a");U(H,$)};j(ge,H=>{d().blurHash!==""?H(Me):H(Ie,!1)})}S(X);var ve=T(X,2),Y=T(P(ve),2),Q=P(Y);S(Y),S(ve);var fe=T(ve,2),Ce=T(P(fe),2),la=P(Ce,!0);S(Ce),S(fe);var Ee=T(fe,2),xe=T(P(Ee),2),ca=P(xe,!0);S(xe);var ua=T(xe,2);{var va=H=>{var $=Tt();Ge(),U(H,$)};j(ua,H=>{d().usedCorsProxy&&H(va)})}S(Ee);var ke=T(Ee,2),fa=T(P(ke),2);{var da=H=>{var $=At();const de=J(()=>d().endDate.getTime()-d().startDate.getTime()),De=J(()=>d().startDate.toLocaleString()+"."+d().startDate.getMilliseconds()),ha=J(()=>d().endDate.toLocaleString()+"."+d().endDate.getMilliseconds());var _a=P($);S($),Z(()=>{le($,"title",`${w(De)??""} - ${w(ha)??""}`),oe(_a,`${w(de)??""} ms`)}),U(H,$)};j(fa,H=>{d().endDate&&H(da)})}S(ke),S(se),S(N),Z(()=>{le(L,"src",d().imageSrc),oe(Q,`${d().xComponents??""} ✕ ${d().yComponents??""}`),le(Ce,"href",d().imageSrc),oe(la,d().imageSrc),ht(xe,`task-status ${d().status??""} svelte-1c9cxpu`),oe(ca,d().status)}),ot("error",L,_),it(L),He(3,N,()=>bt,()=>({x:"50%"})),U(h,N)};let l=ne(""),i=ne(4),f=ne(4),v=ne($e([])),y=ne(!1),E=ne(!1);const x=J(()=>w(v).filter(h=>h.status==="completed").length),u=J(()=>w(v).filter(h=>h.status==="failed").length),s=J(()=>w(l).trim()===""),t=J(()=>w(i)>0&&w(f)>0),n=J(()=>w(s)||!w(t));function o(h){const N=`job-${Math.random().toString(36).substring(2,8)}-${Date.now()}`,R=w(i),L=w(f),b=h.map((C,F)=>$e({id:`${N}-${F}`,url:C,xComponents:R,yComponents:L,blurHash:"",image:new Image,imageSrc:C,blurHashImage:new Image,blurHashImageSrc:"",startDate:new Date,endDate:null,usedCorsProxy:!1,status:"in-progress",error:null}));w(v).unshift(...b);for(const C of b)c(C)}async function c(h){const d=new Date;h.startDate=d;const N=h.url;let R=null,L=!1;const b=new Image;b.crossOrigin="Anonymous";try{await new Promise((Y,Q)=>{b.onload=Y,b.onerror=Q,b.src=N})}catch(Y){R=Y}if(R!=null){R=null;const Y=`https://corsproxy.io/?url=${encodeURIComponent(N)}`;try{await new Promise((Q,fe)=>{b.onload=Q,b.onerror=fe,b.src=Y}),L=!0}catch(Q){R=Q}}if(R!=null){h.status="failed",h.error=R,h.endDate=new Date;return}const C=64;let F=b.width,k=b.height;F>k?F>C&&(k=Math.round(k*C/F),F=C):k>C&&(F=Math.round(F*C/k),k=C);const ue=document.createElement("canvas");ue.width=F,ue.height=k;const se=ue.getContext("2d");if(se==null){h.status="failed",h.error=new Error("Failed to get 2d context"),h.endDate=new Date,h.usedCorsProxy=L;return}se.drawImage(b,0,0,b.width,b.height,0,0,F,k);const X=se.getImageData(0,0,F,k),ge=await Oe.encodePromise(X.data,X.width,X.height,h.xComponents,h.yComponents),Me=await Oe.decodePromise(ge,F,k,1),Ie=await Oe.getImageDataAsImageWithOnloadPromise(Me,F,k),ve=new Date;h.endDate=ve,h.blurHash=ge,h.blurHashImageSrc=Ie.src,h.status="completed",h.usedCorsProxy=L}function _(h){h.target.classList.add("broken-image")}async function p(h,d){try{await navigator.clipboard.writeText(d)}catch(L){console.error("Failed to copy text: ",L);return}const N=h.target;N instanceof HTMLButtonElement&&(N.classList.add("success"),N.disabled=!0,await new Promise(L=>setTimeout(L,1e3)),N.classList.remove("success"),N.disabled=!1)}async function I(){const d=w(v).filter(C=>C.status==="completed").map(C=>({url:C.url,xComponents:C.xComponents,yComponents:C.yComponents,blurHash:C.blurHash})),N=JSON.stringify(d,null,2),R=new Blob([N],{type:"application/json"}),L=URL.createObjectURL(R),b=document.createElement("a");b.href=L,b.download="blur-hashes.json",b.click(),URL.revokeObjectURL(L),W(y,!0),await new Promise(C=>setTimeout(C,2e3)),W(y,!1)}var A=Nt();st(h=>{var d=Mt();Qa.title="BlurHash Encoder",T(ze(d)),U(h,d)});var M=P(A),m=T(P(M),2);nt(m);var g=T(m,2),D=P(g);D.__click=[wt,l,o];var B=T(D,2),O=T(P(B));Pe(O);var q=T(O,2);Pe(q),S(B);var pe=T(B,2),ce=P(pe),me=P(ce),ee=T(me);{var ae=h=>{var d=Pt();d.__click=I;var N=P(d);{var R=b=>{var C=he("Exported");U(b,C)},L=b=>{var C=he("📥 Export");U(b,C)};j(N,b=>{w(y)?b(R):b(L,!1)})}S(d),Z(()=>{d.disabled=w(y),be(d,"success",w(y))}),He(3,d,()=>Qe),U(h,d)};j(ee,h=>{w(x)>0&&h(ae)})}S(ce);var te=T(ce,2),re=P(te),oa=T(re);{var ia=h=>{var d=Ht();d.__click=[yt,v,E];var N=P(d);{var R=b=>{var C=he("Cleared");U(b,C)},L=b=>{var C=he("❌ Clear");U(b,C)};j(N,b=>{w(E)?b(R):b(L,!1)})}S(d),Z(()=>{d.disabled=w(E),be(d,"success",w(E))}),He(3,d,()=>Qe),U(h,d)};j(oa,h=>{(w(u)>0||w(E))&&h(ia)})}S(te),S(pe),S(g),S(M);var Fe=T(M,2),Ue=T(P(Fe),2);ct(Ue,21,()=>w(v),h=>h.id,(h,d)=>{r(h,()=>w(d))}),S(Ue),S(Fe),Ge(2),S(A),Z(()=>{D.disabled=w(n),be(O,"invalid",w(i)<=0),be(q,"invalid",w(f)<=0),oe(me,`Completed: ${w(x)??""} `),oe(re,`Failed: ${w(u)??""} `)}),Ne(m,()=>w(l),h=>W(l,h)),Ne(O,()=>w(i),h=>W(i,h)),Ne(q,()=>w(f),h=>W(f,h)),U(e,A),Xa()}rt(["click"]);export{Bt as component};
